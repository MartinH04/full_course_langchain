1. Langchain 概论

### 1.1.1 为什么需要 Langchain

我们为什么需要 LangChain 呢？

这个问题可以反向思考。我们难道不能只是简单地发送一个 API 请求或模型，然后就算完成了吗？对于简单的应用，确实如此。但一旦你开始增加复杂性，比如将语言模型与你自己的数据（如 Google Analytics、Stripe、SQL、PDF、CSV 等）连接起来，或者使语言模型执行一些操作，比如发送电子邮件、搜索网络或在终端中运行代码，情况就会变得混乱且重复。LangChain 通过提供组件来解决这个问题。

自从 chatgpt 问世以来，LangChain 这个开源框架，已经成为了模型开发中的热门技术。但是硅谷的评论家说 LangChain 只是个“玩具”。

如果没有 Langchain，我们能否开发大语言模型？答案无疑是可以的。但问题在于，为什么在 GPT-4 发布之后，越来越多的开发者选择使用 Langchain 呢？Langchain 的吸引力究竟来自哪里？

### 1.1.2 Langchain 的核心

Langchain 的核心在于它的“组件”和预设的“结构化链”。就像乐高积木一样，Langchain 的组件和链为开发者提供了无限的可能性，使得模型开发变得更加简单和高效。在 LangChain 中，我们可以使用文档加载器从 PDF、HTML 网页等来源加载数据，然后在存储在向量数据库中之前，可以选择使用文本分割器将其分块。在运行时，可以将数据注入到提示模板中，然后作为输入发送给模型。我们还可以使用工具执行一些操作，例如使用输出内容发送电子邮件。这种方式的链是实现这一魔法的方式，我们将组件链接在一起，以完成特定任务。选择 LangChain 意味着你可以轻松地切换到另一个语言模型，以节约成本或享受其他功能，测试另一个向量数据库的功能，或者摄取另一个数据源，只需几行代码即可实现。

你可以把组件看作 Langchain 中的基础单元，它们就像流水线上的工人，每个工人都有明确的工作内容，比如处理数据的输入、输出，或者将数据从一种格式转化为另一种格式。正如同流水线上每个工人的工作都是接力的一部分，这些组件通过协作保证了数据在模型中的正确流动。

那么，结构化链又是什么呢？可以把它想象成一条产品生产线。这条生产线由一系列的组件链接形成，就好像是流水线上的各个工作站。我们只需要按照需求，像选购快餐一样选择不同的链条，就可以完成特定的任务，比如进行文本摘要、窗口记忆，或者会话记忆等。

通过这些组件和链的无限组合，Langchain 可以应对各种复杂场景，就像乐高积木可以拼接出无数种造型。无论是简单的数据处理，还是与现实世界中的软件数据交互，Langchain 都能像万能工具一样胜任。

我们可以举个例子来看看 Langchain 是如何工作的。假设你想让一个语言模型帮你总结一篇 PDF 文档。这似乎是个简单的任务，就像让一个儿童用积木拼出一个小房子一样容易，只需导入文本，然后提示模型进行摘要即可。

但是，如果你要处理 10 个 PDF 文件呢？这就好比你要用积木拼出一个城堡，每个步骤，无论是文档上传、文档切割，还是数据格式转换、查找关联文档，都会变得复杂而繁琐。此时，你或许会意识到 Langchain 的威力，它不再是你眼中的“玩具”，而是一把能助你搭建城堡的神奇工具。

### 1.1.3 模型开发的最后一公里

以最简单的模型交互为例，比如发起一个 get 或 post 的 http 请求，对于初学者来说，这本身就可能是一道难以逾越的门槛。Langchain 的存在，就是为了将这种门槛降低到最低。

这正是 Langchain 的价值所在，只需几行代码，就可以运行一个大语言模型的程序，为开发者们打通了大语言模型开发的最后一公里。

除了代码量的减少，Langchain 还提供了许多预封装的 “轮子”。比如，对于摘要任务，它提供了摘要链。如果你不知道如何编写模型的提示，它提供了各种模板。AI 代理则使我们可以专注于完成任务，而不必分心去处理各种工具。

总的来说，Langchain 解决了两类问题：一是模型与模型间的交流；二是模型与现实世界数据的交互。

如果你采用了 Langchain 的这些组件、链和代理，你只需要学习 Langchain，编写模型的提示，指定要使用的模型厂家，就可以得到结构化的输出，实现与软件世界的无缝连接。你可以在私有环境中部署模型，也可以选择更小、更专业的模型来完成特定的分类任务。

如果你没有使用 Langchain，那么你可能需要独自处理每个模型的接口方式，封装结构化的输入提示，处理输出的格式等问题。每一步都亲历亲为的结果很可能是“从入门到放弃”。

总结起来，无论你是要构建复杂的应用，处理大量数据，还是仅仅是一个初学者，Langchain 都能提供组件和链结合的解决方案，帮助你挖掘大语言模型的无限潜力。
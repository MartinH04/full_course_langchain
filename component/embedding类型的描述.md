3.1.4文本嵌入模型
想要造航母，仅仅一个大语言模型是不够的。假设我们想要创造一个可以聊《红楼梦》的聊天机器人，向其询问有关《红楼梦》的知识，那么一个大语言模型可以做到吗？又或者当我们想要上传专业论文，如长达几十页的临床医学实验报告，或者使用搜索或外部数据的东西，跟真实的数据连接起来时，大语言模型能处理吗？答案是“不能”。虽然最新的模型一直在突破极限，但是仍然不能满足我们想要大模型阅读大型文档、书籍的需求。
面对这些挑战，我们可能需要总结或寻找其他方法来应对。因为大语言模型可以传递的标记数量是有限的，大多数模型最多可以传递1024到16K个标记，尽管一些新的大语言模型可以处理更多的标记。这就意味着，我们需要思考如何有效地利用这些有限的标记，以达到我们的应用需求。
此外，理解模型的类型和其各自的特点也同样重要。模型在高层次上可以分为两种不同类型：大语言模型和文本嵌入模型。文本嵌入模型将文本转换为向量标记，让我们可以将文本标记为向量特征，并显示在向量空间中。了解这两种模型的特性和差异，能帮助我们更好地选择和使用模型，进一步优化我们的应用。
文本嵌入模型将文本转换为向量标记的示例
在自然语言处理（NLP）中，文本嵌入模型是将文本转换为向量的重要工具，由此我们可以在向量空间中表示文本，以便进行后续的机器学习或深度学习任务。例如，我们可以用Word2Vec一个常见的文本嵌入模型，来演示这个过程。
假设有以下语料库：
1. I love learning.
2. I like reading books.
3. Books are great for learning.
首先，我们需要建立一个词汇库，也就是列出所有在语料库中出现过的独立单词：
"I", "love", "learning", "like", "reading", "books", "are", "great", "for"
接下来，用Word2Vec训练这个语料库。Word2Vec是一个预测模型，它试图从上下文预测目标单词，或者从目标单词预测上下文。在训练过程中，Word2Vec会学习到一个单词和它的上下文单词之间的关系，并将这些信息编码到向量中。
训练完成后，每个单词都会被赋予一个向量。例如，“books”的向量可能是：
[0.1, -0.2, 0.3, 0.5, -0.1]
而“learning”的向量可能是：
[-0.1, 0.3, -0.2, 0.1, 0.4]
此时，这些向量代表了对应的单词在向量空间中的位置，并且具有一些有趣的属性。比如，语义上相似的单词在向量空间中的位置会比较接近，我们可以通过计算两个向量之间的余弦相似度来衡量这种接近程度。
文本嵌入模型的原理
在图3-2中，我们可以看到在一个二维空间中，“man”是“king”，“woman”是“queen”，它们代表不同的事物，但我们可以看到一种模式。这个模式可以在向量空间中寻找最相似的文本片段，实现语义搜索。
 
图 3-2 （这个图会重新画）

例如，OpenAI 的文本嵌入模型可以精确地嵌入大段文本，如8100个标记，再根据它们的词对标记比例0.75，计算得出大约可以处理6143个单词，输出1536维的向量。
我们可以使用 LangChain 与多个嵌入提供者进行接口交互，如OpenAI和Cohere的API，也可以通过使用 Hugging Faces 的开源嵌入在本地运行，以达到 免费和数据隐私 的目的。
现在，你可以仅使用4行代码在自己的计算机上创建自己的模型嵌入。但是，维度数量可能会有所不同，嵌入的质量可能会较低，因而导致检索结果不太准确。
安装和设置密钥
安装 Langchain Python 包：
pip install openai langchain
使用文本嵌入模型的简单方法
导入 OpenAIEmbeddings：
from langchain.embeddings import OpenAIEmbeddings

embeddings = OpenAIEmbeddings(openai_api_key = "YOUR_OPENAI_API_TOKEN")
result = embeddings.embed_query("This is an apple.")
打印“result” ，我们就可以看到 “This is an apple.” 这句话的向量空间表达数组：
[0.012008527293801308,
 -0.001835253438912332,
 0.00145026296377182,
 -0.0030227703973650932,
 -0.005661344155669212,
 0.005086636636406183,...]
打印出的数字并不能直观看到这些词在向量空间中的位置，但如果你对向量可视化感兴趣，那么可以访问OpenAI的官方网站，那里有许多关于词嵌入（Embedding）可视化的实践场所（Playground）供你探索和学习。
